<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TelaBola</title>
</head>
<body>
    <h1 class="titulo">Tela Bola</h1>
    <p>
        En esta demo probamos las colisiones contra la malla, dejando caer una malla, generada mediante particulas unidas por 
        muelles, sobre una bola que esta inmobil en el suelo, y cuando la malla cae esta se deforma por la fuerza de la gravedad 
        y la fuerza generada en la colisión. 
    </p>
    <editor-container style="display:block;margin:auto;width:700px;"><math-type style="user-select:text;" class=" math-type-for-print "><math-edit-container><editarea style="font-family: Arial, Helvetica, sans-serif; font-size: 15px;"><area-container><line class="root text-mode selected full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-diagram inline" aria-label="Diagram" role="img"><math-diagram aria-hidden="true" data-amt="diagram" style="height: 259px; z-index: 1;"><clip-region style="width: 100%; height: 100%; display: block; overflow: hidden; position: relative;"><zoom-region><svg><g><defs><pattern id=".23626788311880742" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="lightgray" stroke-width="0.5"></path></pattern></defs><rect width="100%" height="100%" fill="url(#.23626788311880742)" stroke="lightgray" stroke-width="0.5"></rect></g></svg><div class="diagram-plotly-layer" style="position: absolute; inset: 0px; pointer-events: none; fill: none; stroke: none;"><svg style="overflow:visible;position:absolute;left:0;top:0;"></svg></div><svg class="role-diagram-draw-area"><g class="shapes-region" style="stroke: black; fill: none;"><g class="composite-shape"><path class="real" d=" M185.29,3.85 L314.38,98.78 L215.71,227.65 L86.62,132.72 Z" style="stroke-width: 1; stroke: none; fill: none; fill-opacity: 1;"></path><path class="real" d=" M185.29,3.85 L86.62,132.72 M249.74,51.25 L151.07,180.11 M314.19,98.64 L215.52,227.51" style="stroke-width: 1; stroke: rgb(0, 0, 0); fill: none; fill-opacity: 1;"></path><path class="real" d=" M185.29,3.85 L314.38,98.78 M136.64,67.38 L265.74,162.31 M88,130.91 L217.09,225.85" style="stroke-width: 1; stroke: rgb(0, 0, 0); fill: none; fill-opacity: 1;"></path><path class="real" d=" " style="stroke-width: 1; stroke: rgb(0, 0, 0); fill: none; fill-opacity: 1;"></path></g><g class="arrow-line"><path class="connection real" stroke-dasharray="" d="  M87.54,131.52 L313.57,98.19" style="stroke: rgb(0, 0, 0); stroke-width: 1; fill: none; fill-opacity: 1;"></path></g><g class="arrow-line"><path class="connection real" stroke-dasharray="" d="  M185.29,3.85 L215.83,225.86" style="stroke: rgb(0, 0, 0); stroke-width: 1; fill: none; fill-opacity: 1;"></path></g><g class="composite-shape"><path class="real" d=" M273.67,191.17 C273.67,171.19 289.86,155 309.83,155 C329.81,155 346,171.19 346,191.17 C346,211.14 329.81,227.33 309.83,227.33 C289.86,227.33 273.67,211.14 273.67,191.17 Z" style="stroke-width: 1; stroke: rgb(0, 0, 0); fill: none; fill-opacity: 1;"></path></g><g></g></g><g></g><g></g><g></g></svg><diagram-editors><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 242.1px; top: 60.5964px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de8051444973935797" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 257.295px; top: 102.951px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de47768527990713294" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 237.249px; top: 140.592px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de27564489225294087" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 197.12px; top: 168.453px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de002375273155003077" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 153.441px; top: 133.838px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de18941777500468815" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 126.333px; top: 93.9487px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de5077641834992159" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 157.108px; top: 50.4783px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de40999446504479553" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container><position-container data-rotation="36.13" data-skewx="0" data-flipx="false" data-anchor="left-top" style="left: 202.965px; top: 38.0533px; transform: rotate(36.13deg);"><dg-editor-container data-editor-id="de9985878573110112" class="no-border-on-print text-diagram-editor" style="border: 1px solid transparent; transform: translate(0%, 0%); font-size: 15px; font-family: Arial, Helvetica, sans-serif; font-weight: normal; font-style: normal;"><editarea class="diagram-editor non-wrap no-area-container text-mode" style="font-size: 1em;"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;"><editarea class="math-mode-font lazyable no-area-container" style="font-family: Asana-Math, Asana;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">L</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">0</editarea-block></compositeblock></line></editarea></compositeblock></blocks></line></editarea></dg-editor-container></position-container></diagram-editors></zoom-region><svg style="position: absolute; width: 100%; height: 100%; overflow: visible; left: 0px; top: 0px; pointer-events: none;"></svg></clip-region></math-diagram></compositeblock></blocks></line></area-container></editarea><div></div></math-edit-container></math-type></editor-container>
    <p>
        Para tratar las colisiones he utilizado el modelo basado en fuerzas, y en cada iteracción compruebo si la pelota 
        colisiona con alguna partícula de la malla, porque comprobar todas las particulas de la malla sería mas costoso.
    </p>
    <pre><code><span class="hljs-keyword">void</span> ComputeCollisions(Particle[][] nodes)
        {
           <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; N_H; i++)
           {
              <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> j = <span class="hljs-number">0</span>; j &lt; N_V; j++)
              {
                 <span class="hljs-keyword">if</span>(nodes[i][j] != <span class="hljs-keyword">null</span>)
                 {
                    <span class="hljs-built_in">float</span> distanciaMinima = _r;
                    <span class="hljs-built_in">float</span> distancia = <span class="hljs-keyword">PVector</span>.sub(nodes[i][j].getPosition(), _s).<span class="hljs-built_in">mag</span>();
                    <span class="hljs-keyword">if</span>(distancia &lt; distanciaMinima)
                    {
                       <span class="hljs-keyword">PVector</span> <span class="hljs-built_in">normal</span> = <span class="hljs-keyword">PVector</span>.sub(nodes[i][j].getPosition(), _s);
                       <span class="hljs-built_in">normal</span>.normalize();
                       <span class="hljs-keyword">PVector</span> normal2 = <span class="hljs-keyword">PVector</span>.mult(<span class="hljs-built_in">normal</span>, <span class="hljs-number">-1</span>);
                       <span class="hljs-built_in">float</span> dif_elongacion = <span class="hljs-built_in">abs</span>(distancia - distanciaMinima);
                       <span class="hljs-built_in">float</span> fuerza_elastica = K_E_COLISION * dif_elongacion;
                       _F.<span class="hljs-built_in">add</span>(<span class="hljs-keyword">PVector</span>.mult(normal2,fuerza_elastica));
                       nodes[i][j].addExternalForce(<span class="hljs-keyword">PVector</span>.mult(<span class="hljs-built_in">normal</span>,fuerza_elastica));
                    }
                 }
              }
           }
        }
     </code></pre>
    <h5>Resultado Final:</h5>
    <div class="d-flex justify-content-center">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/d2iNbIel4wA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
</body>
</html>